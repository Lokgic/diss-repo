plot(x,y2,type = 'l',xlab="Beta(11,11)", ylab="", yaxt='n')
plot(x,y3, type='l',xlab="Beta(50001,50001)", ylab="",yaxt='n')
a = 1
b = 1
a2 = 11
b2 = 11
a3 = 50001
b3 = 50001
x = seq(0,1,by=0.001)
y1 = dbeta(x,a,b)
y2 = dbeta(x,a2,b2)
y3  = dbeta(x,a3,b3)
par(mfrow=c(1,3))
plot(x,y1,type='l',xlab="Beta(1,1)", ylab="",yaxt='n')
plot(x,y2,type = 'l',xlab="Beta(11,11)", ylab="", yaxt='n')
plot(x,y3, type='l',xlab="Beta(50001,50001)", ylab="",yaxt='n')
plot(x,y1,type='l',main="Beta(1,1)", ylab="",yaxt='n')
plot(x,y1,type='l',main="Beta(1,1)", xlab="theta", ylab="",yaxt='n')
plot(x,y1,type='l',main="Beta(1,1)", xlab="x:theta", ylab="",yaxt='n')
plot(x,y1,type='l',main="Beta(1,1)", xlab="x:theta", ylab="",yaxt='n')
plot(x,y2,type = 'l',main="Beta(11,11)", xlab="x:theta", ylab="", yaxt='n')
plot(x,y3, type='l',main="Beta(50001,50001)", xlab="x:theta", ylab="",yaxt='n')
a = 1
b = 1
a2 = 11
b2 = 11
a3 = 500001
b3 = 500001
x = seq(0,1,by=0.001)
y1 = dbeta(x,a,b)
y2 = dbeta(x,a2,b2)
y3  = dbeta(x,a3,b3)
par(mfrow=c(1,3))
plot(x,y1,type='l',main="Beta(1,1)", xlab="x:theta", ylab="",yaxt='n')
plot(x,y2,type = 'l',main="Beta(11,11)", xlab="x:theta", ylab="", yaxt='n')
plot(x,y3, type='l',main="Beta(500001,500001)", xlab="x:theta", ylab="",yaxt='n')
pbeta(higher1,a,b)- pbeta(lower1,a,b)
pbeta(higher1,a2,b2)-pbeta(lower1,a2,b2)
pbeta(higher1,a3,b3)-pbeta(lower1,a3,b3)
lower1 = 0.46
higher1 = 0.54
lower2 = 0.49
higher2 = 0.51
pbeta(higher1,a,b)- pbeta(lower1,a,b)
pbeta(higher1,a2,b2)-pbeta(lower1,a2,b2)
pbeta(higher1,a3,b3)-pbeta(lower1,a3,b3)
pbeta(higher2,a,b)- pbeta(lower2,a,b)
pbeta(higher2,a2,b2)-pbeta(lower2,a2,b2)
pbeta(higher2,a3,b3)-pbeta(lower2,a3,b3)
x = seq(0,1, by=0.1)
x
x = seq(0,1, by=0.01)
y = dbeta(x, 5,5)
plot(xy)
plot(x,y)
a1 = 1
b1 = 1
a2 = 1000000
b2 = 1000000
x = seq(1,10000, by = 1)
se
x
gete = function(a,b,x){
de = a + b + x
nom = b + x
return (nom/de)
}
y = getx(a1,b1,x)
y = gete(a1,b1,x)
y
plot(x,y)
y2 = gete(a2,b2,x)
plot(x,y2)
plot(x,y2, type='l')
plot(x,y, type = 'l')
lines(x,y2, type = 'l')
line(x,y2, type = 'l')
lines(x,y2)
line(x,y2)
x2
y2
x
x = seq(1,1000, by = 1)
y = getx(a1,b1,x)
y = gete(a1,b1,x)
y = gete(a2,b2,x2)
y = gete(a2,b2,x)
plot(x,y, type = 'l')
y = gete(a1,b1,x)
y2 = gete(a2,b2,x)
plot(x,y, type = 'l')
x = seq(1,200, by = 1)
a0 = 1
b0 = 1
a1 = 20
b1 = 20
y0 = gete(a0,b0,x)
y1 = gete(a1,b1,x)
y2 = gete(a2,b2,x)
plot(x,y1)
line(x,y2)
lines(x,y2)
plot(x,y3)
plot(x,y0)
lines(x,y1)
lines(x,y2)
plot(x,y0,ylim=c(0.45,1))
lines(x,y1)
lines(x,y2)
plot(x,y0,ylim=c(0.45,1),type = 'l')
lines(x,y1)
lines(x,y2)
a0 = 1
b0 = 1
a1 = 20
b2 = 20
a3 = 1000000
b3 = 1000000
y0 = gete(a0,b0,x)
y1 = gete(a1,b1,x)
y2 = gete(a2,b2,x)
lines(x,y1)
lines(x,y2)
plot(x,y0,ylim=c(0.45,1),type = 'l')
plot(x,y0,ylim=c(0.45,1),type = 'l')
lines(x,y1)
lines(x,y2)
lines(x,y2)
a0 = 1
b0 = 1
a1 = 20
b1 = 20
a2 = 1000000
b2 = 1000000
y0 = gete(a0,b0,x)
y1 = gete(a1,b1,x)
y2 = gete(a2,b2,x)
plot(x,y0,ylim=c(0.45,1),type = 'l')
lines(x,y1)
lines(x,y2)
x
x = seq(0,100, by = 1)
a0 = 1
b0 = 1
a1 = 20
b1 = 20
a2 = 1000000
b2 = 1000000
y0 = gete(a0,b0,x)
y1 = gete(a1,b1,x)
y2 = gete(a2,b2,x)
plot(x,y0,ylim=c(0.45,1),type = 'l')
lines(x,y1)
lines(x,y2)
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number Heads", ylab=P(H|X))
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number Heads", ylab="P(H|X)")
lines(x,y1)
lines(x,y2)
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number of heads", ylab="P(H|X)")
lines(x,y1)
lines(x,y2)
lines(x,y1, color=2)
lines(x,y1, col=2)
lines(x,y2, col=3)
legend(0.55, 90, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(0.55, 90, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(0.55, 90, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend
legend
?legend
legend(0.55, 90, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(90, 0.55, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(90, 0.6, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number of heads", ylab="P(H|X)")
lines(x,y1, col=2)
lines(x,y2, col=3)
legend(90, 0.6, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number of heads", ylab="P(H|X)")
lines(x,y1, col=2)
lines(x,y2, col=3)
legend(90, 0.7, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(80, 0.7, legend=c("No evidence", "Some Evidence", "Ideal Evidence"),
col=c(0,1,2), lty=1:2, cex=0.8)
legend(80, 0.7, legend=c("No evidence", "Some Evidence", "Ideal Evidence"),
col=c(1,2,3), lty=1, cex=0.8)
plot(x,y0,ylim=c(0.45,1),type = 'l', xlab="X: number of heads", ylab="P(H|X)")
lines(x,y1, col=2)
lines(x,y2, col=3)
legend(80, 0.7, legend=c("No evidence", "Some Evidence", "Ideal Evidence"),
col=c(1,2,3), lty=1, cex=0.8)
choose()
choose(5,3)
choose(5,3) * .5^3 * .5^2
choose(5,1) * .5 * .5^4
choose(5,0) * .5^5
pbinom(1,5,.5)
pbinom(0,5,.5)
pbinom(1,5,.5)
pnbinom(500-110,110,.2)
x = 100
pnbinom(500-x,x,.2)
x = 120
pnbinom(500-x,x,.2)
x = 115
pnbinom(500-x,x,.2)
1 - pbinom(114,500,.2)
1 - pbinom(x,500,.2)
1 - pbinom(x-1,500,.2)
x = 110
1 - pbinom(x-1,500,.2)
pnbinom(500-x,x,.2)
x = 110
1 - pbinom(x-1,500,.2)
pnbinom(500-x,x,.2)
n = 20
x= 5
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 20
x= 6
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 500
x= 118
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 50
x= 11
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 5
x= 2
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 50
x= 1
1 - pbinom(x-1,n,.2)
pnbinom(n-x,x,.2)
n = 50
x= 1
p=.2
1 - pbinom(x-1,n,p)
pnbinom(n-x,x,p)
n = 50
x= 1
p=.1
1 - pbinom(x-1,n,p)
pnbinom(n-x,x,p)
n = 500
x= 1:500
p=.1
plot(x, 1 - pbinom(x-1,n,p))
plot(x, 1 - pbinom(x-1,n,p),type='l')
n = 500
x= 1:500
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
n = 200
x= 1:n
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
n = 55
x= 1:n
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
plot(1:20, 1 - pbinom(x-1,n,p),type='l')
n = 500
x= 1:n
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
line(x,pnbinom(n-x,x,p))
lines(x,pnbinom(n-x,x,p))
plot(x,pnbinom(n-x,x,p))
n = 10
x= 3
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
plot(x,pnbinom(n-x,x,p))
1 - pbinom(x-1,n,p)
pnbinom(n-x,x,p)
n = 10
x= 1:10
p=.2
plot(x, 1 - pbinom(x-1,n,p),type='l')
plot(x,pnbinom(n-x,x,p))
plot(x, 1 - pbinom(x-1,n,p),type='l')
lines(x,pnbinom(n-x,x,p),type='l', color='blue')
plot(x, 1 - pbinom(x-1,n,p),type='l',color='blue')
plot
?plot
plot(x, 1 - pbinom(x-1,n,p),type='l',col='blue')
lines(x,pnbinom(n-x,x,p),type='l')
n = 50
x= 1:50
p=.1
plot(x, 1 - pbinom(x-1,n,p),type='l',col='blue')
lines(x,pnbinom(n-x,x,p),type='l')
plot(x, 1 - pbinom(x-1,n,p),type='l',col='blue')
plot(n-x, pnbinom(n-x,x,p),type='l',col='blue')
pbinom(9,12,0.5)
1 -pbinom(9,12,0.5)
pbinom(3,12,0.5)
1 - pnbinom(9,3,0.5)
pbinom()
pbinom
?pbinom
?pnbinom
pbinom(1,1,0.5)
pbinom(0,1,0.5)
pbinom(1,1,0.5)
pnbinom(1,1,0.5)
dnbinom(9,3,0.5)
sum(dnbinom(10:3000,3,0.5))
sum(dnbinom(9:3000,3,0.5))
1 - pnbinom(8,3,0.5)
1 - pbinom(8,12,0.5)
pbinom(9,12,0.5)
1- pbinom(9,12,0.5)
1- pbinom(8,12,0.5)
pbinom(3,12,0.5)
1 - pnbinom(8,3,0.5)
pbinom(3,12,0.2)
1 - pnbinom(8,3,0.2)
1 - pbinom(8,12,0.2)
1 - pbinom(2,12,0.2)
pbinom(2,12,0.2)
1-pbinom(2,12,0.2)
pnbinom(8,3,0.2)
n = 12
x= 2
p=.2
1 - pbinom(x-1,n,p)
pnbinom(n-x,x,p)
n = 12
x= 3
p=.2
1 - pbinom(x-1,n,p)
pnbinom(n-x,x,p)
1-pbinom(2,12,0.2)
pnbinom(8,3,0.2)
pnbinom(9,3,0.2)
pbinom(3,12,0.5)
sum(choose(3+i-1,i)*0.5^3 *0.5^i)
i=1:8
sum(choose(3+i-1,i)*0.5^3 *0.5^i)
i=0:8
sum(choose(3+i-1,i)*0.5^3 *0.5^i)
1-sum(choose(3+i-1,i)*0.5^3 *0.5^i)
1 - pnbinom(8,3,0.2)
1 - pnbinom(8,3,0.5)
dbinom(1,5,0.2)
1-pbinom(0,5,0.2)
choose
choose(5,0) * .8^5
1 - choose(5,0) * .8^5
1 - choose(5,0) * .7^5
1-pbinom(0,5,0.3)
b = 5000
a = 5100
a/(a+b)
a=5500
a/(a+b)
a=5400
a/(a+b)
a=5300
a/(a+b)
a=5200
a/(a+b)
pbinom(3,12,0.5)
pbinom(3,12,0.1)
x = seq(0,1,by=0.01)
plot(x,pbinom(3,12,x))
plot(x,pbinom(3,12,x),type='l')
pbinom(3,12,0.5)
pbinom(2,12,0.5)
1- pnbinom(8,3,.5)
1- pnbinom(7,3,.5)
1- pnbinom(8,3,.5)
1- pnbinom(9,3,.5)
1- pnbinom(10,3,.5)
1- pnbinom(8,3,.5)
pbinom(2,12,0.5)
pbinom(2,12,0.2)
pbinom(2,12,0.3)
plot(x,pbinom(2,12,x),type='l')
pbinom(2,12,0.3)
pbinom(2,12,0.4)
1- pnbinom(8,3,.5)
1- pnbinom(8,3,.5)
1- pnbinom(8,3,.4)
1- pnbinom(27,100,.2)
1- pnbinom(100,27,.2)
1- pbinom(100,26,.2)
pbinom
1- pbinom(26,100,.2)
1- pbinom(27,100,.2)
setwd("~/Dropbox/diss/repo/src")
h = read.csv("simFreqStopping.csv")
h
View(h)
plot(hist$pv)
plot(h$pv)
hist(h$pv)
xv = vector(mode="integer",length = 1000)
nv = vector(mode="integer",length = 1000)
xv = vector(mode="integer",length = 1000)
nv = vector(mode="integer",length = 1000)
rbinom(1000,2000,0.2)
xv = rbinom(1000,2000,0.2)
hist(xv)
hist(binom.test(x,2000,0.2,alternative="greater"))
x
hist(binom.test(xv,2000,0.2,alternative="greater"))
hist(binom.test(xv,2000,0.2,alternative="greater"))
?apply
hist(binom.test(xv,2000,0.2,alternative="greater"))
binom.test(400,2000,0.2,alternative="greater")
xv
xv[1]
xp = sapply(xv,2000,0.2,binom.test)
xp = sapply(xv,binom.test,c(2000,0.2))
xp = sapply(xv,binom.test,2000,0.2)
xp
xp[1]
xp[1,]
xp[,1]
xp$p.value
xp[1,]
xp[1,1]
xp[2,1]
xp[3,1]
xp[3,]
hist(xp[3,])
View(xp)
xp = sapply(xv,binom.test,2000,0.2,alternative="greater")
xp[,3]
xp[1,]
xp[3,]
xp[3,][1]
just = xp[3,]
just
just[1,]
just[1]
just[,1]
just[1,]
as.vector(just)
test =as.vector(just)
test
test[1]
test[1][1]
test[1][1][1]
test[[1]]
test[[1],]
test[[1]]
test[,1]
unlist(test)
bip = unlist(test)
hist(bip)
View(h)
hist(h$pv)
hist(h$pv,main="")
?hist
hist(h$pv,xaxt='n')
hist(h$pv,xaxt='n',xlab="p value")
hist(h$pv,xaxt='n',xlab="p value",breaks="20")
hist(h$pv,xaxt='n',xlab="p value",breaks=20)
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(h$pv,xaxt='n',xlab="p value",breaks=20, main="Optionally Stopped Simulations")
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
just
test
hist(unlist(test),xaxt='n',xlab="p value",breaks=20, main="Fixed N Simulations")
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
par(mfrow=c(1,2))
hist(binom.test(xv,2000,0.2,alternative="greater"))
hist(h$pv,xaxt='n',xlab="p value",breaks=20, main="Optionally Stopped Simulations")
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(unlist(test),xaxt='n',xlab="p value",breaks=20, main="Fixed N Simulations")
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(h$pv,xaxt='n',xlab="p value",breaks=20, main="Optionally Stopped Simulations",ylim=c(0,400))
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(unlist(test),xaxt='n',xlab="p value",breaks=20, main="Fixed N Simulations",xlim=c(0,400))
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(unlist(test),xaxt='n',xlab="p value",breaks=20, main="Fixed N Simulations",ylim=c(0,400))
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
hist(h$pv,xaxt='n',xlab="p value",breaks=20, main="Optionally Stopped Simulations",ylim=c(0,400))
axis(side=1, at=seq(0,1, 0.05), labels=seq(0,1, 0.05))
pv
xp
View(xp)
xp[1,]
unlist(xp[1,])
hist(unlist(xp[1,]))
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial")
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial")
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial")
hist(h$nv,xlab="Successes",main="Optional Stopping Binomial")
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial")
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial")
hist(h$nv,xlab="Successes",main="Optional Stopping Binomial")
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial",ylim=c(0,700))
hist(h$nv,xlab="Successes",main="Optional Stopping Binomial",ylim=c(0,700))
hist(unlist(xp[1,]),xlab="Successes",main="Fixed N Binomial",ylim=c(0,700))
hist(h$xv,xlab="Successes",main="Optional Stopping Binomial",ylim=c(0,700))
